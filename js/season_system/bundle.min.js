/*!
 * 合并的 JavaScript 包
 * 生成时间: 2026/2/6 23:59:03
 * 文件数量: 8
 * 依赖顺序:
 * 1. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager.js
 * 2. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser.js
 * 3. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/effect_scheduler.js
 * 4. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/season_determination.js
 * 5. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_period_identifier.js
 * 6. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection.js
 * 7. ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_manager.js
 * 8. ../../../D:/WorkSpace/IIS/static/source/js/season_system/manager.js
 */

(function() {
  'use strict';

  // 模块缓存
  var __modules = {};
  var __cache = {};

  // require 函数
  function __require(moduleId) {
    if (__cache[moduleId]) {
      return __cache[moduleId].exports;
    }
    
    var module = __cache[moduleId] = {
      exports: {}
    };
    
    __modules[moduleId].call(module.exports, module, module.exports, __require);
    
    return module.exports;
  }

  // 模块定义

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager"] = function(module, exports, __require) {
    /**
     * 效果比重管理器
     * 用于管理四季系统中各种效果的比重
     */
    class WeightManager {
      constructor() {
        this.effects = new Map();
        this.seasonEffects = new Map();
        this.timePeriodEffects = new Map();
        this.seasonTimePeriodEffects = new Map();
        this.originalWeights = new Map(); // 记录每个效果的原始比重
        this.lastResetDate = null; // 上次重置日期
        this.defaultWeight = 30;
      }
    
      /**
       * 添加效果
       * @param {string} effectId - 效果ID
       * @param {Object} effectConfig - 效果配置
       * @param {number} weight - 比重 (0-100，数字越大比重越高)
       * @param {string} season - 季节
       * @param {string} timePeriod - 时段
       */
      addEffect(effectId, effectConfig, weight = this.defaultWeight, season = null, timePeriod = null) {
        if (typeof weight !== 'number' || weight < 0 || weight > 100) {
          throw new Error('比重必须是0-100之间的数字');
        }
    
        const effect = {
          id: effectId,
          config: effectConfig,
          weight: weight,
          season: season,
          timePeriod: timePeriod
        };
    
        this.effects.set(effectId, effect);
        this.originalWeights.set(effectId, weight); // 存储原始比重
    
        // 按季节分组
        if (season) {
          if (!this.seasonEffects.has(season)) {
            this.seasonEffects.set(season, new Map());
          }
          this.seasonEffects.get(season).set(effectId, effect);
        }
    
        // 按时段分组
        if (timePeriod) {
          if (!this.timePeriodEffects.has(timePeriod)) {
            this.timePeriodEffects.set(timePeriod, new Map());
          }
          this.timePeriodEffects.get(timePeriod).set(effectId, effect);
        }
    
        // 按季节+时段分组
        if (season && timePeriod) {
          const key = `${season}_${timePeriod}`;
          if (!this.seasonTimePeriodEffects.has(key)) {
            this.seasonTimePeriodEffects.set(key, new Map());
          }
          this.seasonTimePeriodEffects.get(key).set(effectId, effect);
        }
    
        return this;
      }
    
      /**
       * 移除效果
       * @param {string} effectId - 效果ID
       */
      removeEffect(effectId) {
        if (this.effects.has(effectId)) {
          const effect = this.effects.get(effectId);
          // 从季节分组中移除
          if (effect.season && this.seasonEffects.has(effect.season)) {
            this.seasonEffects.get(effect.season).delete(effectId);
            if (this.seasonEffects.get(effect.season).size === 0) {
              this.seasonEffects.delete(effect.season);
            }
          }
          // 从时段分组中移除
          if (effect.timePeriod && this.timePeriodEffects.has(effect.timePeriod)) {
            this.timePeriodEffects.get(effect.timePeriod).delete(effectId);
            if (this.timePeriodEffects.get(effect.timePeriod).size === 0) {
              this.timePeriodEffects.delete(effect.timePeriod);
            }
          }
          // 从季节+时段分组中移除
          if (effect.season && effect.timePeriod) {
            const key = `${effect.season}_${effect.timePeriod}`;
            if (this.seasonTimePeriodEffects.has(key)) {
              this.seasonTimePeriodEffects.get(key).delete(effectId);
              if (this.seasonTimePeriodEffects.get(key).size === 0) {
                this.seasonTimePeriodEffects.delete(key);
              }
            }
          }
          this.effects.delete(effectId);
          this.originalWeights.delete(effectId); // 从原始比重映射中移除
        }
        return this;
      }
    
      /**
       * 重置所有效果的比重到原始值
       */
      resetWeightsToOriginal() {
        for (const [effectId, originalWeight] of this.originalWeights.entries()) {
          const effect = this.effects.get(effectId);
          if (effect) {
            this.updateWeight(effectId, originalWeight);
          }
        }
        this.lastResetDate = new Date().toDateString();
        console.log('效果比重已重置到原始值');
        return this;
      }
    
      /**
       * 检查并执行每日重置
       */
      checkAndResetDaily() {
        const today = new Date().toDateString();
        if (this.lastResetDate !== today) {
          this.resetWeightsToOriginal();
        }
        return this;
      }
    
      /**
       * 获取效果的原始比重
       * @param {string} effectId - 效果ID
       */
      getOriginalWeight(effectId) {
        return this.originalWeights.get(effectId);
      }
    
      /**
       * 更新效果比重
       * @param {string} effectId - 效果ID
       * @param {number} weight - 新的比重
       */
      
      updateWeight(effectId, weight) {
        if (!this.effects.has(effectId)) {
          throw new Error(`效果 ${effectId} 不存在`);
        }
    
        if (typeof weight !== 'number' || weight < 0 || weight > 100) {
          throw new Error('比重必须是0-100之间的数字');
        }
    
        const oldEffect = this.effects.get(effectId);
        const updatedEffect = {
          ...oldEffect,
          weight: weight
        };
    
        this.effects.set(effectId, updatedEffect);
    
        // 更新季节分组中的效果
        if (oldEffect.season && this.seasonEffects.has(oldEffect.season)) {
          this.seasonEffects.get(oldEffect.season).set(effectId, updatedEffect);
        }
    
        // 更新时段分组中的效果
        if (oldEffect.timePeriod && this.timePeriodEffects.has(oldEffect.timePeriod)) {
          this.timePeriodEffects.get(oldEffect.timePeriod).set(effectId, updatedEffect);
        }
    
        // 更新季节+时段分组中的效果
        if (oldEffect.season && oldEffect.timePeriod) {
          const key = `${oldEffect.season}_${oldEffect.timePeriod}`;
          if (this.seasonTimePeriodEffects.has(key)) {
            this.seasonTimePeriodEffects.get(key).set(effectId, updatedEffect);
          }
        }
    
        return this;
      }
    
      /**
       * 获取效果
       * @param {string} effectId - 效果ID
       */
      getEffect(effectId) {
        return this.effects.get(effectId);
      }
    
      /**
       * 获取所有效果
       */
      getAllEffects() {
        return Array.from(this.effects.values());
      }
    
      /**
       * 根据时间解析结果获取效果
       * @param {Object} timeInfo - 时间解析结果
       */
      getEffectsByTimeInfo(timeInfo) {
        const season = timeInfo.season ? timeInfo.season.name : null;
        const timePeriod = timeInfo.timePeriod ? timeInfo.timePeriod.name : null;
    
        // 如果没有季节或时段信息，返回空数组
        if (!season || !timePeriod) {
          return [];
        }
    
        // 尝试获取同时匹配季节和时段的效果
        const key = `${season}_${timePeriod}`;
        if (this.seasonTimePeriodEffects.has(key)) {
          return Array.from(this.seasonTimePeriodEffects.get(key).values());
        }
    
        return [];
      }
    
      /**
       * 获取指定季节的效果
       * @param {string} season - 季节
       */
      getEffectsBySeason(season) {
        if (!this.seasonEffects.has(season)) {
          return [];
        }
        return Array.from(this.seasonEffects.get(season).values());
      }
    
      /**
       * 获取指定时段的效果
       * @param {string} timePeriod - 时段
       */
      getEffectsByTimePeriod(timePeriod) {
        if (!this.timePeriodEffects.has(timePeriod)) {
          return [];
        }
        return Array.from(this.timePeriodEffects.get(timePeriod).values());
      }
    
      /**
       * 根据比重随机选择一个效果
       * @param {Array} effects - 效果列表，如果不提供则使用所有效果
       * @param {boolean} considerOccurrences - 是否考虑出现次数来调整权重
       */
      getRandomEffectByWeight(effects = null, considerOccurrences = true) {
        const effectList = effects || this.getAllEffects();
        if (effectList.length === 0) {
          return null;
        }
    
        // 过滤掉权重为0的效果
        const validEffects = effectList.filter(effect => effect.weight > 0);
        if (validEffects.length === 0) {
          return null;
        }
    
        // 计算总比重
        const totalWeight = validEffects.reduce((sum, effect) => sum + effect.weight, 0);
        if (totalWeight === 0) {
          // 如果总比重为0，随机选择
          return validEffects[Math.floor(Math.random() * validEffects.length)];
        }
    
        // 生成随机数
        let random = Math.random() * totalWeight;
    
        // 根据比重选择效果
        for (const effect of validEffects) {
          random -= effect.weight;
          if (random <= 0) {
            return effect;
          }
        }
    
        // 以防万一，返回最后一个效果
        return validEffects[validEffects.length - 1];
      }
    
      /**
       * 根据时间解析结果和比重随机选择一个效果
       * @param {Object} timeInfo - 时间解析结果
       */
      getRandomEffectByTimeInfo(timeInfo) {
        const seasonTimePeriodEffects = this.getEffectsByTimeInfo(timeInfo);
        return this.getRandomEffectByWeight(seasonTimePeriodEffects, true);
      }
    
      /**
       * 检查是否存在指定效果
       * @param {string} effectId - 效果ID
       */
      hasEffect(effectId) {
        return this.effects.has(effectId);
      }
    
      /**
       * 清空所有效果
       */
      clearAllEffects() {
        this.effects.clear();
        this.seasonEffects.clear();
        this.timePeriodEffects.clear();
        this.seasonTimePeriodEffects.clear();
        this.originalWeights.clear();
        this.lastResetDate = null;
        return this;
      }
    
      /**
       * 获取比重统计信息
       */
      getWeightStats() {
        const stats = {
          totalEffects: this.effects.size,
          seasonDistribution: {},
          totalWeight: 0
        };
    
        if (this.effects.size > 0) {
          stats.totalWeight = Array.from(this.effects.values()).reduce((sum, effect) => sum + effect.weight, 0);
    
          // 按季节统计
          for (const [season, effects] of this.seasonEffects.entries()) {
            stats.seasonDistribution[season] = {
              count: effects.size,
              totalWeight: Array.from(effects.values()).reduce((sum, effect) => sum + effect.weight, 0)
            };
          }
        }
    
        return stats;
      }
    }
    
    // 导出单例实例
    const weightManager = new WeightManager();
    exports.default = weightManager;
    exports.WeightManager = WeightManager;;
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser"] = function(module, exports, __require) {
    /**
     * 本地时间解析模块
     * 负责解析本地时间，提供时间相关的基础功能
     */
    
    class LocalTimeParser {
      /**
       * 获取当前本地时间
       * @returns {Date} 当前本地时间对象
       */
      getCurrentTime() {
        return new Date();
      }
    
      /**
       * 获取时间的各个部分
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {Object} 包含时间各个部分的对象
       */
      getTimeComponents(date = new Date()) {
        return {
          year: date.getFullYear(),
          month: date.getMonth() + 1, // 月份从0开始，所以+1
          day: date.getDate(),
          hour: date.getHours(),
          minute: date.getMinutes(),
          second: date.getSeconds(),
          millisecond: date.getMilliseconds(),
          dayOfWeek: date.getDay() // 0-6，0表示星期日
        };
      }
    
      /**
       * 格式化时间
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @param {string} format - 格式化字符串，默认 'YYYY-MM-DD HH:mm:ss'
       * @returns {string} 格式化后的时间字符串
       */
      formatTime(date = new Date(), format = 'YYYY-MM-DD HH:mm:ss') {
        const components = this.getTimeComponents(date);
        
        return format
          .replace('YYYY', components.year)
          .replace('MM', String(components.month).padStart(2, '0'))
          .replace('DD', String(components.day).padStart(2, '0'))
          .replace('HH', String(components.hour).padStart(2, '0'))
          .replace('mm', String(components.minute).padStart(2, '0'))
          .replace('ss', String(components.second).padStart(2, '0'));
      }
    
      /**
       * 获取时间戳
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {number} 时间戳（毫秒）
       */
      getTimestamp(date = new Date()) {
        return date.getTime();
      }
    
      /**
       * 从时间戳创建日期对象
       * @param {number} timestamp - 时间戳（毫秒）
       * @returns {Date} 日期对象
       */
      fromTimestamp(timestamp) {
        return new Date(timestamp);
      }
    }
    
    module.exports = new LocalTimeParser();
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/effect_scheduler
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/effect_scheduler"] = function(module, exports, __require) {
    /**
     * 效果调度器
     * 用于根据比重调度和执行四季系统的效果
     */
    var weightManager = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager");;
    
    class EffectScheduler {
      constructor() {
        this.runningEffects = new Set();
        this.effectHandlers = new Map();
        this.maxConcurrentEffects = 10;
      }
    
      /**
       * 注册效果处理器
       * @param {string} effectType - 效果类型
       * @param {Function} handler - 效果处理函数
       */
      registerEffectHandler(effectType, handler) {
        if (typeof handler !== 'function') {
          throw new Error('效果处理器必须是函数');
        }
        this.effectHandlers.set(effectType, handler);
        return this;
      }
    
      /**
       * 移除效果处理器
       * @param {string} effectType - 效果类型
       */
      removeEffectHandler(effectType) {
        this.effectHandlers.delete(effectType);
        return this;
      }
    
      /**
       * 获取效果处理器
       * @param {string} effectType - 效果类型
       */
      getEffectHandler(effectType) {
        return this.effectHandlers.get(effectType);
      }
    
      /**
       * 添加效果
       * @param {string} effectId - 效果ID
       * @param {Object} effectConfig - 效果配置
       * @param {number} weight - 比重
       * @param {string} season - 季节
       * @param {string} timePeriod - 时段
       */
      addEffect(effectId, effectConfig, weight, season = null, timePeriod = null) {
        weightManager.addEffect(effectId, effectConfig, weight, season, timePeriod);
        return this;
      }
    
      /**
       * 移除效果
       * @param {string} effectId - 效果ID
       */
      removeEffect(effectId) {
        if (this.runningEffects.has(effectId)) {
          this.stopEffect(effectId);
        }
        weightManager.removeEffect(effectId);
        return this;
      }
    
      /**
       * 更新效果比重
       * @param {string} effectId - 效果ID
       * @param {number} weight - 新的比重
       */
      updateEffectWeight(effectId, weight) {
        weightManager.updateWeight(effectId, weight);
        return this;
      }
    
      /**
       * 执行效果
       * @param {string} effectId - 效果ID
       */
      async executeEffect(effectId) {
        // 检查并执行每日重置
        weightManager.checkAndResetDaily();
    
        const effect = weightManager.getEffect(effectId);
        if (!effect) {
          throw new Error(`效果 ${effectId} 不存在`);
        }
    
        const { type } = effect.config;
        const handler = this.getEffectHandler(type);
        if (!handler) {
          throw new Error(`未注册效果类型 ${type} 的处理器`);
        }
    
        if (this.runningEffects.has(effectId)) {
          console.warn(`效果 ${effectId} 已经在运行中`);
          return;
        }
    
        if (this.runningEffects.size >= this.maxConcurrentEffects) {
          console.warn('达到最大并发效果数量，等待执行');
          // 可以实现队列机制，这里简化处理
          return;
        }
    
        this.runningEffects.add(effectId);
    
        try {
          console.log(`开始执行效果: ${effectId} (比重: ${effect.weight})`);
          await handler(effect.config);
          console.log(`效果执行完成: ${effectId}`);
    
          // 执行完成后，将该效果的比重下降5%
          const newWeight = Math.max(0, effect.weight * 0.95);
          weightManager.updateWeight(effectId, newWeight);
          console.log(`效果 ${effectId} 比重已调整为: ${newWeight.toFixed(1)}`);
        } catch (error) {
          console.error(`效果执行出错: ${effectId}`, error);
        } finally {
          this.runningEffects.delete(effectId);
        }
      }
    
      /**
       * 停止效果
       * @param {string} effectId - 效果ID
       */
      stopEffect(effectId) {
        // 这里可以添加具体的效果停止逻辑
        // 例如取消动画、清除定时器等
        this.runningEffects.delete(effectId);
        console.log(`效果已停止: ${effectId}`);
        return this;
      }
    
      /**
       * 执行所有效果
       */
      async executeAllEffects() {
        const effects = weightManager.getAllEffects();
        for (const effect of effects) {
          await this.executeEffect(effect.id);
        }
      }
    
      /**
       * 执行指定季节的效果
       * @param {string} season - 季节
       */
      async executeEffectsBySeason(season) {
        const effects = weightManager.getEffectsBySeason(season);
        for (const effect of effects) {
          await this.executeEffect(effect.id);
        }
      }
    
      /**
       * 根据时间解析结果执行效果
       * @param {Object} timeInfo - 时间解析结果
       */
      async executeEffectsByTimeInfo(timeInfo) {
        const effects = weightManager.getEffectsByTimeInfo(timeInfo);
        for (const effect of effects) {
          await this.executeEffect(effect.id);
        }
      }
    
      /**
       * 随机执行一个效果（根据比重）
       * @param {Object} timeInfo - 时间解析结果，如果提供则只从对应季节的效果中选择
       */
      async executeRandomEffect(timeInfo = null) {
        let effect;
        if (timeInfo) {
          effect = weightManager.getRandomEffectByTimeInfo(timeInfo);
        } else {
          effect = weightManager.getRandomEffectByWeight();
        }
    
        if (effect) {
          await this.executeEffect(effect.id);
        }
        return effect;
      }
    
      /**
       * 获取运行中的效果
       */
      getRunningEffects() {
        return Array.from(this.runningEffects);
      }
    
      /**
       * 获取效果统计信息
       */
      getStats() {
        const weightStats = weightManager.getWeightStats();
        return {
          ...weightStats,
          runningEffects: this.runningEffects.size,
          registeredHandlers: this.effectHandlers.size,
          maxConcurrentEffects: this.maxConcurrentEffects
        };
      }
    
      /**
       * 设置最大并发效果数量
       * @param {number} max - 最大并发数量
       */
      setMaxConcurrentEffects(max) {
        if (typeof max !== 'number' || max <= 0) {
          throw new Error('最大并发数量必须是正整数');
        }
        this.maxConcurrentEffects = max;
        return this;
      }
    
      /**
       * 清空所有效果
       */
      clearAllEffects() {
        // 停止所有运行中的效果
        for (const effectId of this.runningEffects) {
          this.stopEffect(effectId);
        }
        weightManager.clearAllEffects();
        return this;
      }
    }
    
    // 导出单例实例
    const effectScheduler = new EffectScheduler();
    exports.default = effectScheduler;
    exports.EffectScheduler = EffectScheduler;;
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/season_determination
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/season_determination"] = function(module, exports, __require) {
    /**
     * 季节判定逻辑模块
     * 负责根据日期判定当前季节
     */
    
    var __imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser");
    var getTimeComponents = function() { return __imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser.getTimeComponents.apply(__imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser, arguments); };;
    
    class SeasonDetermination {
      /**
       * 季节常量
       */
      static SEASONS = {
        SPRING: 'spring',
        SUMMER: 'summer',
        AUTUMN: 'autumn',
        WINTER: 'winter'
      };
    
      /**
       * 获取当前季节
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {string} 当前季节的英文名称
       */
      getCurrentSeason(date = new Date()) {
        const components = getTimeComponents(date);
        const month = components.month;
        const day = components.day;
    
        // 根据月份和日期判断季节
        // 春季：3月21日 - 6月20日
        // 夏季：6月21日 - 9月22日
        // 秋季：9月23日 - 12月20日
        // 冬季：12月21日 - 3月20日
        
        if ((month === 3 && day >= 21) || (month === 4) || (month === 5) || (month === 6 && day <= 20)) {
          return SeasonDetermination.SEASONS.SPRING;
        } else if ((month === 6 && day >= 21) || (month === 7) || (month === 8) || (month === 9 && day <= 22)) {
          return SeasonDetermination.SEASONS.SUMMER;
        } else if ((month === 9 && day >= 23) || (month === 10) || (month === 11) || (month === 12 && day <= 20)) {
          return SeasonDetermination.SEASONS.AUTUMN;
        } else {
          return SeasonDetermination.SEASONS.WINTER;
        }
      }
    
      /**
       * 获取季节的中文名称
       * @param {string} season - 季节的英文名称
       * @returns {string} 季节的中文名称
       */
      getSeasonChineseName(season) {
        const seasonMap = {
          [SeasonDetermination.SEASONS.SPRING]: '春季',
          [SeasonDetermination.SEASONS.SUMMER]: '夏季',
          [SeasonDetermination.SEASONS.AUTUMN]: '秋季',
          [SeasonDetermination.SEASONS.WINTER]: '冬季'
        };
    
        return seasonMap[season] || season;
      }
    
      /**
       * 获取季节的开始和结束日期
       * @param {string} season - 季节的英文名称
       * @param {number} year - 年份，默认使用当前年份
       * @returns {Object} 包含开始和结束日期的对象
       */
      getSeasonDateRange(season, year = new Date().getFullYear()) {
        const ranges = {
          [SeasonDetermination.SEASONS.SPRING]: {
            start: new Date(year, 2, 21), // 3月21日
            end: new Date(year, 5, 20)    // 6月20日
          },
          [SeasonDetermination.SEASONS.SUMMER]: {
            start: new Date(year, 5, 21), // 6月21日
            end: new Date(year, 8, 22)    // 9月22日
          },
          [SeasonDetermination.SEASONS.AUTUMN]: {
            start: new Date(year, 8, 23), // 9月23日
            end: new Date(year, 11, 20)   // 12月20日
          },
          [SeasonDetermination.SEASONS.WINTER]: {
            start: new Date(year, 11, 21), // 12月21日
            end: new Date(year + 1, 2, 20) // 次年3月20日
          }
        };
    
        return ranges[season] || null;
      }
    
      /**
       * 检查给定日期是否在指定季节内
       * @param {Date} date - 日期对象
       * @param {string} season - 季节的英文名称
       * @returns {boolean} 是否在指定季节内
       */
      isDateInSeason(date, season) {
        const targetSeason = this.getCurrentSeason(date);
        return targetSeason === season;
      }
    }
    
    exports.default = new SeasonDetermination();
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_period_identifier
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_period_identifier"] = function(module, exports, __require) {
    /**
     * 时段识别模块
     * 负责识别一天中的时段（晨/午/晚/夜）
     */
    
    var __imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser");
    var getTimeComponents = function() { return __imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser.getTimeComponents.apply(__imported__________D__WorkSpace_IIS_static_source_js_season_system_season_manager_time_detection_local_time_parser, arguments); };;
    
    class TimePeriodIdentifier {
      /**
       * 时段常量
       */
      static TIME_PERIODS = {
        MORNING: 'morning',      // 早晨
        AFTERNOON: 'afternoon',  // 下午
        EVENING: 'evening',      // 晚上
        NIGHT: 'night'           // 夜晚
      };
    
      /**
       * 获取当前时段
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {string} 当前时段的英文名称
       */
      getCurrentTimePeriod(date = new Date()) {
        const components = getTimeComponents(date);
        const hour = components.hour;
    
        // 根据小时判断时段
        // 早晨：6:00 - 12:00
        // 下午：12:00 - 18:00
        // 晚上：18:00 - 22:00
        // 夜晚：22:00 - 6:00
        
        if (hour >= 6 && hour < 12) {
          return TimePeriodIdentifier.TIME_PERIODS.MORNING;
        } else if (hour >= 12 && hour < 18) {
          return TimePeriodIdentifier.TIME_PERIODS.AFTERNOON;
        } else if (hour >= 18 && hour < 22) {
          return TimePeriodIdentifier.TIME_PERIODS.EVENING;
        } else {
          return TimePeriodIdentifier.TIME_PERIODS.NIGHT;
        }
      }
    
      /**
       * 获取时段的中文名称
       * @param {string} timePeriod - 时段的英文名称
       * @returns {string} 时段的中文名称
       */
      getTimePeriodChineseName(timePeriod) {
        const periodMap = {
          [TimePeriodIdentifier.TIME_PERIODS.MORNING]: '早晨',
          [TimePeriodIdentifier.TIME_PERIODS.AFTERNOON]: '下午',
          [TimePeriodIdentifier.TIME_PERIODS.EVENING]: '晚上',
          [TimePeriodIdentifier.TIME_PERIODS.NIGHT]: '夜晚'
        };
    
        return periodMap[timePeriod] || timePeriod;
      }
    
      /**
       * 获取时段的开始和结束时间
       * @param {string} timePeriod - 时段的英文名称
       * @returns {Object} 包含开始和结束小时的对象
       */
      getTimePeriodRange(timePeriod) {
        const ranges = {
          [TimePeriodIdentifier.TIME_PERIODS.MORNING]: {
            start: 6,
            end: 12
          },
          [TimePeriodIdentifier.TIME_PERIODS.AFTERNOON]: {
            start: 12,
            end: 18
          },
          [TimePeriodIdentifier.TIME_PERIODS.EVENING]: {
            start: 18,
            end: 22
          },
          [TimePeriodIdentifier.TIME_PERIODS.NIGHT]: {
            start: 22,
            end: 6
          }
        };
    
        return ranges[timePeriod] || null;
      }
    
      /**
       * 检查给定时间是否在指定时段内
       * @param {Date} date - 日期对象
       * @param {string} timePeriod - 时段的英文名称
       * @returns {boolean} 是否在指定时段内
       */
      isTimeInPeriod(date, timePeriod) {
        const targetPeriod = this.getCurrentTimePeriod(date);
        return targetPeriod === timePeriod;
      }
    
      /**
       * 获取下一个时段
       * @param {string} currentPeriod - 当前时段的英文名称
       * @returns {string} 下一个时段的英文名称
       */
      getNextTimePeriod(currentPeriod) {
        const periodOrder = [
          TimePeriodIdentifier.TIME_PERIODS.MORNING,
          TimePeriodIdentifier.TIME_PERIODS.AFTERNOON,
          TimePeriodIdentifier.TIME_PERIODS.EVENING,
          TimePeriodIdentifier.TIME_PERIODS.NIGHT
        ];
    
        const currentIndex = periodOrder.indexOf(currentPeriod);
        if (currentIndex === -1) {
          return null;
        }
    
        const nextIndex = (currentIndex + 1) % periodOrder.length;
        return periodOrder[nextIndex];
      }
    }
    
    exports.default = new TimePeriodIdentifier();
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection"] = function(module, exports, __require) {
    /**
     * 时间检测模块主入口
     * 整合本地时间解析、季节判定和时段识别功能
     */
    
    var localTimeParser = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/local_time_parser");
    var getTimeComponents = function() { return localTimeParser.getTimeComponents.apply(localTimeParser, arguments); };
    var formatTime = function() { return localTimeParser.formatTime.apply(localTimeParser, arguments); };;
    var seasonDetermination = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/season_determination").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/season_determination");
    var getCurrentSeason = function() { return seasonDetermination.getCurrentSeason.apply(seasonDetermination, arguments); };
    var getSeasonChineseName = function() { return seasonDetermination.getSeasonChineseName.apply(seasonDetermination, arguments); };
    var getSeasonDateRange = function() { return seasonDetermination.getSeasonDateRange.apply(seasonDetermination, arguments); };
    var isDateInSeason = function() { return seasonDetermination.isDateInSeason.apply(seasonDetermination, arguments); };;
    var timePeriodIdentifier = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_period_identifier").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_period_identifier");
    var getCurrentTimePeriod = function() { return timePeriodIdentifier.getCurrentTimePeriod.apply(timePeriodIdentifier, arguments); };
    var getTimePeriodChineseName = function() { return timePeriodIdentifier.getTimePeriodChineseName.apply(timePeriodIdentifier, arguments); };
    var getTimePeriodRange = function() { return timePeriodIdentifier.getTimePeriodRange.apply(timePeriodIdentifier, arguments); };
    var isTimeInPeriod = function() { return timePeriodIdentifier.isTimeInPeriod.apply(timePeriodIdentifier, arguments); };;
    
    class TimeDetection {
      /**
       * 获取本地时间解析器
       * @returns {Object} 本地时间解析器实例
       */
      getLocalTimeParser() {
        return localTimeParser;
      }
    
      /**
       * 获取季节判定器
       * @returns {Object} 季节判定器实例
       */
      getSeasonDetermination() {
        return seasonDetermination;
      }
    
      /**
       * 获取时段识别器
       * @returns {Object} 时段识别器实例
       */
      getTimePeriodIdentifier() {
        return timePeriodIdentifier;
      }
    
      /**
       * 获取当前时间信息
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {Object} 包含时间、季节和时段信息的对象
       */
      getCurrentTimeInfo(date = new Date()) {
        const timeComponents = getTimeComponents(date);
        const season = getCurrentSeason(date);
        const timePeriod = getCurrentTimePeriod(date);
    
        return {
          time: date,
          components: timeComponents,
          season: {
            name: season,
            chineseName: getSeasonChineseName(season),
            range: getSeasonDateRange(season, timeComponents.year)
          },
          timePeriod: {
            name: timePeriod,
            chineseName: getTimePeriodChineseName(timePeriod),
            range: getTimePeriodRange(timePeriod)
          },
          formattedTime: formatTime(date)
        };
      }
    
      /**
       * 检查是否为特定季节
       * @param {string} season - 季节的英文名称
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {boolean} 是否为特定季节
       */
      isSeason(season, date = new Date()) {
        return isDateInSeason(date, season);
      }
    
      /**
       * 检查是否为特定时段
       * @param {string} timePeriod - 时段的英文名称
       * @param {Date} date - 可选的日期对象，默认使用当前时间
       * @returns {boolean} 是否为特定时段
       */
      isTimePeriod(timePeriod, date = new Date()) {
        return isTimeInPeriod(date, timePeriod);
      }
    
      /**
       * 获取时间检测的所有常量
       * @returns {Object} 包含所有常量的对象
       */
      getConstants() {
        return {
          seasons: seasonDetermination.constructor.SEASONS,
          timePeriods: timePeriodIdentifier.constructor.TIME_PERIODS
        };
      }
    }
    
    exports.default = new TimeDetection();
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_manager
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_manager"] = function(module, exports, __require) {
    /**
     * 时间管理器
     * 作为上层模块调用时间检测模块中的功能，并提供定时任务和时间监听等高级功能
     */
    
    var timeDetection = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection");;
    
    class TimeManager {
      constructor() {
        this.timeDetection = timeDetection;
        this.timers = new Map(); // 存储定时任务
        this.listeners = new Map(); // 存储时间监听器
        this.lastTimeInfo = null; // 上次的时间信息
      }
    
      /**
       * 获取当前时间信息
       * @returns {Object} 包含时间、季节和时段信息的对象
       */
      getCurrentTimeInfo() {
        const timeInfo = this.timeDetection.getCurrentTimeInfo();
        return timeInfo;
      }
    
      /**
       * 获取时间检测模块
       * @returns {Object} 时间检测模块实例
       */
      getTimeDetection() {
        return this.timeDetection;
      }
    
      /**
       * 执行定时任务
       * @param {string} taskName - 任务名称
       * @param {Function} callback - 回调函数
       * @param {number} delay - 延迟时间（毫秒）
       * @returns {string} 任务ID
       */
      setTimeout(taskName, callback, delay) {
        const timerId = setTimeout(() => {
          callback();
          this.timers.delete(taskName);
        }, delay);
    
        this.timers.set(taskName, timerId);
        return taskName;
      }
    
      /**
       * 执行重复定时任务
       * @param {string} taskName - 任务名称
       * @param {Function} callback - 回调函数
       * @param {number} interval - 间隔时间（毫秒）
       * @returns {string} 任务ID
       */
      setInterval(taskName, callback, interval) {
        const timerId = setInterval(callback, interval);
        this.timers.set(taskName, timerId);
        return taskName;
      }
    
      /**
       * 清除定时任务
       * @param {string} taskName - 任务名称
       * @returns {boolean} 是否成功清除
       */
      clearTimer(taskName) {
        const timerId = this.timers.get(taskName);
        if (timerId) {
          clearTimeout(timerId);
          clearInterval(timerId);
          this.timers.delete(taskName);
          return true;
        }
        return false;
      }
    
      /**
       * 清除所有定时任务
       */
      clearAllTimers() {
        for (const [taskName, timerId] of this.timers) {
          clearTimeout(timerId);
          clearInterval(timerId);
        }
        this.timers.clear();
      }
    
      /**
       * 添加时间监听器
       * @param {string} eventType - 事件类型（seasonChange, timePeriodChange, minuteChange等）
       * @param {Function} callback - 回调函数
       * @returns {string} 监听器ID
       */
      addListener(eventType, callback) {
        if (!this.listeners.has(eventType)) {
          this.listeners.set(eventType, new Map());
        }
    
        const listenerId = `${eventType}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        this.listeners.get(eventType).set(listenerId, callback);
    
        return listenerId;
      }
    
      /**
       * 移除时间监听器
       * @param {string} eventType - 事件类型
       * @param {string} listenerId - 监听器ID
       * @returns {boolean} 是否成功移除
       */
      removeListener(eventType, listenerId) {
        if (this.listeners.has(eventType)) {
          const eventListeners = this.listeners.get(eventType);
          if (eventListeners.has(listenerId)) {
            eventListeners.delete(listenerId);
            return true;
          }
        }
        return false;
      }
    
      /**
       * 移除所有指定类型的监听器
       * @param {string} eventType - 事件类型
       */
      removeAllListeners(eventType) {
        if (this.listeners.has(eventType)) {
          this.listeners.get(eventType).clear();
        }
      }
    
      /**
       * 触发时间事件
       * @param {string} eventType - 事件类型
       * @param {Object} eventData - 事件数据
       */
      emit(eventType, eventData) {
        if (this.listeners.has(eventType)) {
          const eventListeners = this.listeners.get(eventType);
          for (const callback of eventListeners.values()) {
            callback(eventData);
          }
        }
      }
    
      /**
       * 启动时间监控
       * @param {number} interval - 监控间隔（毫秒），默认1000ms
       */
      startMonitoring(interval = 1000) {
        this.setInterval('timeMonitoring', () => {
          const currentTimeInfo = this.getCurrentTimeInfo();
    
          // 检查季节变化
          if (this.lastTimeInfo && this.lastTimeInfo.season.name !== currentTimeInfo.season.name) {
            this.emit('seasonChange', {
              oldSeason: this.lastTimeInfo.season,
              newSeason: currentTimeInfo.season,
              timeInfo: currentTimeInfo
            });
          }
    
          // 检查时段变化
          if (this.lastTimeInfo && this.lastTimeInfo.timePeriod.name !== currentTimeInfo.timePeriod.name) {
            this.emit('timePeriodChange', {
              oldTimePeriod: this.lastTimeInfo.timePeriod,
              newTimePeriod: currentTimeInfo.timePeriod,
              timeInfo: currentTimeInfo
            });
          }
    
          // 检查分钟变化
          if (!this.lastTimeInfo || this.lastTimeInfo.components.minute !== currentTimeInfo.components.minute) {
            this.emit('minuteChange', {
              timeInfo: currentTimeInfo
            });
          }
    
          // 检查小时变化
          if (!this.lastTimeInfo || this.lastTimeInfo.components.hour !== currentTimeInfo.components.hour) {
            this.emit('hourChange', {
              timeInfo: currentTimeInfo
            });
          }
    
          // 检查日期变化
          if (!this.lastTimeInfo || this.lastTimeInfo.components.day !== currentTimeInfo.components.day) {
            this.emit('dayChange', {
              timeInfo: currentTimeInfo
            });
          }
          this.lastTimeInfo = currentTimeInfo;
        }, interval);
      }
    
      /**
       * 停止时间监控
       */
      stopMonitoring() {
        this.clearTimer('timeMonitoring');
      }
    
      /**
       * 获取所有定时任务
       * @returns {Array} 定时任务列表
       */
      getAllTimers() {
        return Array.from(this.timers.keys());
      }
    
      /**
       * 获取所有监听器
       * @returns {Object} 监听器列表
       */
      getAllListeners() {
        const result = {};
        for (const [eventType, eventListeners] of this.listeners) {
          result[eventType] = Array.from(eventListeners.keys());
        }
        return result;
      }
    
      /**
       * 销毁时间管理器
       */
      destroy() {
        this.clearAllTimers();
        this.listeners.clear();
        this.lastTimeInfo = null;
      }
    }
    
    exports.default = new TimeManager();
  };

  // 模块: ../../../D:/WorkSpace/IIS/static/source/js/season_system/manager
  __modules["../../../D:/WorkSpace/IIS/static/source/js/season_system/manager"] = function(module, exports, __require) {
    /**
     * 四季系统主入口文件
     * 提供系统核心功能的统一访问接口
     */
    
    // 引入时间管理器
    var timeManager = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_manager").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_manager");;
    
    // 引入时间检测模块
    var timeDetection = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/time_detection/time_detection");;
    
    /**
     * 效果调度器模块入口
     * 导出效果比重管理相关的组件
     */
    var weightManager = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/priority_manager");;
    var effectScheduler = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/effect_scheduler").default || __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/season_manager/effect_scheduler/effect_scheduler");;
    
    /**
     * 四季系统主类
     */
    class SeasonSystem {
      /**
       * 构造函数
       */
      constructor() {
        this.timeManager = timeManager;
        this.timeDetection = timeDetection;
        this.weightManager = weightManager;
        this.effectScheduler = effectScheduler;
        this.isMonitoringStarted = false;
       }
    
      /**
       * 获取时间管理器
       * @returns {Object} 时间管理器实例
       */
      getTimeManager() {
        return this.timeManager;
      }
    
      /**
       * 获取时间检测模块
       * @returns {Object} 时间检测模块实例
       */
      getTimeDetection() {
        return this.timeDetection;
      }
    
      /**
       * 获取当前时间信息
       * @returns {Object} 包含时间、季节和时段信息的对象
       */
      getCurrentTimeInfo() {
        return this.timeManager.getCurrentTimeInfo();
      }
    
      /**
       * 启动时间监控
       * @param {number} interval - 监控间隔（毫秒），默认1000ms
       */
      startTimeMonitoring(interval = 1000) {
        if (!this.isMonitoringStarted) {
          this.timeManager.startMonitoring(interval);
          this.isMonitoringStarted = true;
          console.log('四季系统：时间监控已启动');
        }
      }
    
      /**
       * 停止时间监控
       */
      stopTimeMonitoring() {
        if (this.isMonitoringStarted) {
          this.timeManager.stopMonitoring();
          this.isMonitoringStarted = false;
          console.log('四季系统：时间监控已停止');
        }
      }
    
      /**
       * 添加时间监听器
       * @param {string} eventType - 事件类型
       * @param {Function} callback - 回调函数
       * @returns {string} 监听器ID
       */
      addTimeListener(eventType, callback) {
        return this.timeManager.addListener(eventType, callback);
      }
    
      /**
       * 移除时间监听器
       * @param {string} eventType - 事件类型
       * @param {string} listenerId - 监听器ID
       * @returns {boolean} 是否成功移除
       */
      removeTimeListener(eventType, listenerId) {
        return this.timeManager.removeListener(eventType, listenerId);
      }
    
      /**
       * 执行定时任务
       * @param {string} taskName - 任务名称
       * @param {Function} callback - 回调函数
       * @param {number} delay - 延迟时间（毫秒）
       * @returns {string} 任务ID
       */
      setTimeout(taskName, callback, delay) {
        return this.timeManager.setTimeout(taskName, callback, delay);
      }
    
      /**
       * 执行重复定时任务
       * @param {string} taskName - 任务名称
       * @param {Function} callback - 回调函数
       * @param {number} interval - 间隔时间（毫秒）
       * @returns {string} 任务ID
       */
      setInterval(taskName, callback, interval) {
        return this.timeManager.setInterval(taskName, callback, interval);
      }
    
      /**
       * 清除定时任务
       * @param {string} taskName - 任务名称
       * @returns {boolean} 是否成功清除
       */
      clearTimer(taskName) {
        return this.timeManager.clearTimer(taskName);
      }
    
      /**
       * 清除所有定时任务
       */
      clearAllTimers() {
        this.timeManager.clearAllTimers();
      }
    
      /**
       * 获取系统状态
       * @returns {Object} 系统状态信息
       */
      getStatus() {
        return {
          isMonitoringStarted: this.isMonitoringStarted,
          currentTimeInfo: this.getCurrentTimeInfo(),
          timers: this.timeManager.getAllTimers(),
          listeners: this.timeManager.getAllListeners()
        };
      }
    
      /**
       * 销毁系统实例
       */
      destroy() {
        this.stopTimeMonitoring();
        this.clearAllTimers();
        console.log('四季系统：实例已销毁');
      }
    }
    
    // 创建系统实例
    const seasonSystem = new SeasonSystem();
    
    // 导出系统实例
    exports.default = seasonSystem;
    
    // 导出系统类（用于创建新实例）
    const _SeasonSystem = SeasonSystem;
    exports.SeasonSystem = _SeasonSystem;;
    
    // 导出时间相关模块（方便直接访问）
    const _timeManager = timeManager;
    exports.timeManager = _timeManager;;
    const _timeDetection = timeDetection;
    exports.timeDetection = _timeDetection;;
    
    // 导出效果相关模块（方便直接访问）
    const _weightManager = weightManager;
    exports.weightManager = _weightManager;;
    const _effectScheduler = effectScheduler;
    exports.effectScheduler = _effectScheduler;;
  };

  // 启动应用并导出主模块
  // 检测环境并设置导出对象
  var entryModule = __require("../../../D:/WorkSpace/IIS/static/source/js/season_system/manager");
  var exportValue = entryModule.default || entryModule;
  
  // 根据环境导出
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = exportValue;
  } else if (typeof window !== 'undefined') {
    // 在浏览器环境中，将导出值挂载到 window 对象
    window.Bundle = exportValue;
  } else if (typeof global !== 'undefined') {
    global.Bundle = exportValue;
  }
})();